<UserControl x:Class="SimpleAccountBook.Controls.Calendar.CustomCalendarControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <!-- 날짜 칸 스타일 -->
        <Style x:Key="DayCellStyle" TargetType="Border">
            <Setter Property="BorderBrush" Value="{DynamicResource CalendarCellBorderBrush}" />
            <Setter Property="BorderThickness" Value="0.5" />
            <Setter Property="Background" Value="{DynamicResource CalendarCellBackgroundBrush}" />
            <Setter Property="MinHeight" Value="60" />
        </Style>

        <!-- 요일 헤더 스타일 -->
		<Style x:Key="DayHeaderStyle" TargetType="TextBlock">
			<Setter Property="FontWeight" Value="Bold" />
			<Setter Property="HorizontalAlignment" Value="Center" />
			<Setter Property="VerticalAlignment" Value="Center" />
			<Setter Property="Padding" Value="5" />
            <Setter Property="Foreground" Value="{DynamicResource CalendarTextBrush}" />
		</Style>

		<!-- 주간 합계 스타일 -->
        <Style x:Key="WeeklySumStyle" TargetType="Border">
            <Setter Property="BorderBrush" Value="{DynamicResource CalendarHeaderBorderBrush}" />
            <Setter Property="BorderThickness" Value="0.5" />
            <Setter Property="Background" Value="{DynamicResource CalendarWeeklySumBackgroundBrush}" />
            <Setter Property="MinHeight" Value="60" />
        </Style>

        <Style x:Key="CalendarNavigationButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource ButtonBackgroundBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource ButtonBorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Foreground" Value="{DynamicResource CalendarNavigationButtonBrush}" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="0">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="Transparent" />
                                <Setter Property="Foreground" Value="{DynamicResource CalendarNavigationButtonHoverBrush}" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="Transparent" />
                                <Setter Property="Foreground" Value="{DynamicResource CalendarNavigationButtonHoverBrush}" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="{DynamicResource DisabledTextBrush}" />
                                <Setter TargetName="Border" Property="Background" Value="{DynamicResource ButtonBackgroundBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<!-- 년월 네비게이션 -->
			<RowDefinition Height="Auto" />
			<!-- 요일 헤더 -->
			<RowDefinition Height="*" />
			<!-- 달력 본체 -->
		</Grid.RowDefinitions>

		<!-- 년월 네비게이션 -->
		<Border Grid.Row="0" Background="{DynamicResource CalendarNavigationBackgroundBrush}" Padding="6,6,6,6">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="Auto" />
				</Grid.ColumnDefinitions>

                <Button x:Name="PrevMonthButton"
                        Style="{StaticResource CalendarNavigationButtonStyle}"
                        Grid.Column="0"
                        Content="◀"
                        Width="30"
                        Height="30"
                        Click="PrevMonthButton_Click" />

				<TextBlock x:Name="CurrentMonthText"
                           Grid.Column="1"
                           Text="2025년 9월"
                           FontSize="16"
                           FontWeight="Bold"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center" 
                           FontFamily="Segoe UI Light"
                           Cursor="Hand"
                           MouseLeftButtonUp="CurrentMonthText_MouseLeftButtonUp"
                           Foreground="{DynamicResource CalendarTextBrush}" />

                <Button x:Name="NextMonthButton"
                        Style="{StaticResource CalendarNavigationButtonStyle}"
                        Grid.Column="2"
                        Content="▶"
                        Width="30"
                        Height="30"
                        Click="NextMonthButton_Click" />
			</Grid>
		</Border>

		<!-- 요일 헤더 -->
		<Grid Grid.Row="1" Background="{DynamicResource CalendarHeaderBackgroundBrush}">
			<Grid.ColumnDefinitions>
                <ColumnDefinition Width="85" />
				<!-- 일 -->
                <ColumnDefinition Width="85" />
				<!-- 월 -->
                <ColumnDefinition Width="85" />
				<!-- 화 -->
                <ColumnDefinition Width="85" />
				<!-- 수 -->
                <ColumnDefinition Width="85" />
				<!-- 목 -->
                <ColumnDefinition Width="85" />
				<!-- 금 -->
                <ColumnDefinition Width="85" />
				<!-- 토 -->
				<ColumnDefinition Width="*" />
				<!-- 주간합계 -->
			</Grid.ColumnDefinitions>

			<Border Grid.Column="0" BorderBrush="{DynamicResource CalendarHeaderBorderBrush}" BorderThickness="0.5">
				<TextBlock Text="일" Style="{StaticResource DayHeaderStyle}" Foreground="{DynamicResource SundayTextBrush}" />
			</Border>
			<Border Grid.Column="1" BorderBrush="{DynamicResource CalendarHeaderBorderBrush}" BorderThickness="0.5">
				<TextBlock Text="월" Style="{StaticResource DayHeaderStyle}" />
			</Border>
			<Border Grid.Column="2" BorderBrush="{DynamicResource CalendarHeaderBorderBrush}" BorderThickness="0.5">
				<TextBlock Text="화" Style="{StaticResource DayHeaderStyle}" />
			</Border>
			<Border Grid.Column="3" BorderBrush="{DynamicResource CalendarHeaderBorderBrush}" BorderThickness="0.5">
				<TextBlock Text="수" Style="{StaticResource DayHeaderStyle}" />
			</Border>
			<Border Grid.Column="4" BorderBrush="{DynamicResource CalendarHeaderBorderBrush}" BorderThickness="0.5">
				<TextBlock Text="목" Style="{StaticResource DayHeaderStyle}" />
			</Border>
			<Border Grid.Column="5" BorderBrush="{DynamicResource CalendarHeaderBorderBrush}" BorderThickness="0.5">
				<TextBlock Text="금" Style="{StaticResource DayHeaderStyle}" />
			</Border>
			<Border Grid.Column="6" BorderBrush="{DynamicResource CalendarHeaderBorderBrush}" BorderThickness="0.5">
				<TextBlock Text="토" Style="{StaticResource DayHeaderStyle}" Foreground="{DynamicResource SaturdayTextBrush}" />
			</Border>
			<Border Grid.Column="7" BorderBrush="{DynamicResource CalendarHeaderBorderBrush}" BorderThickness="0.5" Background="{DynamicResource CalendarHeaderBackgroundBrush}">
				<TextBlock Text="주간합계" Style="{StaticResource DayHeaderStyle}" />
			</Border>
		</Grid>

		<!-- 달력 본체 (6주 x 8칸) -->
		<Grid x:Name="CalendarGrid" Grid.Row="2">
			<Grid.RowDefinitions>
				<RowDefinition Height="65" />
				<RowDefinition Height="65" />
                <RowDefinition Height="65" />
                <RowDefinition Height="65" />
                <RowDefinition Height="65" />
                <RowDefinition Height="65" />
            </Grid.RowDefinitions>
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="85" />
                <ColumnDefinition Width="85" />
                <ColumnDefinition Width="85" />
                <ColumnDefinition Width="85" />
                <ColumnDefinition Width="85" />
                <ColumnDefinition Width="85" />
                <ColumnDefinition Width="85" />
				<ColumnDefinition Width="*" />
			</Grid.ColumnDefinitions>

			<!-- 동적으로 날짜 칸과 주간합계 칸이 추가됨 -->
        </Grid>

        <Popup x:Name="MonthYearPopup"
               Placement="Bottom"
               PlacementTarget="{Binding ElementName=CurrentMonthText}"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Focusable="False">
            <Border Background="{DynamicResource PanelBackgroundBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Padding="12">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10"
                                      ShadowDepth="2"
                                      Opacity="0.2" />
                </Border.Effect>
                <StackPanel>
                    <TextBlock Text="이동할 년월을 선택하세요"
                               Margin="0,0,0,8"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"
                               Foreground="{DynamicResource PrimaryTextBrush}" />
                    <UniformGrid Columns="2" Margin="0,0,0,8" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <ComboBox x:Name="YearComboBox"
                                  Width="110"
                                  Margin="0,0,8,0" />
                        <ComboBox x:Name="MonthComboBox"
                                  Width="90" />
                    </UniformGrid>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="이동"
                                Width="60"
                                Margin="0,0,6,0"
                                Click="ApplyMonthYearSelection_Click" />
                        <Button Content="취소"
                                Width="60"
                                Click="CancelMonthYearSelection_Click" />
                    </StackPanel>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</UserControl>
